<!DOCTYPE html>
<html>
<head><title>Send My Location</title></head>
<style>
  body, html {
    height: 100%;
    margin: 0;
    display: flex;
    justify-content: center; 
    align-items: center;   
  }
    
  button {
    background-color: red;
    color: white;
    border: none;
    border-radius: 12px;
    padding: 20px 40px;
    font-size: 24px;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }

  button:hover {
    background-color: darkred;
  }
  }
</style>
<body>
<button onclick="start()">Start Sending Location</button>

<script>
let socket, watchId;

function start() {
  socket = new WebSocket('wss://f529db88fe95.ngrok-free.app/bus'); // use your server IP

  socket.onopen = () => {
    if ('geolocation' in navigator) {
      watchId = navigator.geolocation.watchPosition(
        (pos) => {
          if (socket.readyState === WebSocket.OPEN) {
            const speed = (pos.coords.speed !== null && pos.coords.speed !== undefined) ? pos.coords.speed : 0;
            socket.send(JSON.stringify({
              latitude: pos.coords.latitude,
              longitude: pos.coords.longitude,
              speed: speed,
            }));
          }
        },
        (err) => {
          console.error('Geolocation error:', err);
        },
        { enableHighAccuracy: true }
      );
    } else {
      alert('Geolocation not supported');
    }
  };

  socket.onclose = () => {
    if (watchId) navigator.geolocation.clearWatch(watchId);
  };

  socket.onerror = (err) => {
    console.error('WebSocket error:', err);
  };
}
</script>

</body>
</html>




